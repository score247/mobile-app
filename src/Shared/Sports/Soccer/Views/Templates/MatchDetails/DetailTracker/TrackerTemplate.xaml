<?xml version="1.0" encoding="UTF-8"?>
<DataTemplate xmlns="http://xamarin.com/schemas/2014/forms"
              xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
              xmlns:d="http://xamarin.com/schemas/2014/forms/design"
              xmlns:resources="clr-namespace:LiveScore.Soccer.ViewResources"
              xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:tabStrip="clr-namespace:LiveScore.Core.Controls.TabStrip;assembly=LiveScore.Core"
              mc:Ignorable="d"
              x:Class="LiveScore.Soccer.Views.Templates.DetailTracker.TrackerTemplate">
    <FlexLayout Direction="Column">
        <FlexLayout.Resources>
            <ResourceDictionary>
                <ResourceDictionary.MergedDictionaries>
                    <resources:MatchDetailViewResource />
                    <resources:MatchDetailTrackerViewResource />
                </ResourceDictionary.MergedDictionaries>
            </ResourceDictionary>
        </FlexLayout.Resources>
        <ActivityIndicator Margin="20"
                           IsRunning="{Binding IsBusy}"
                           IsVisible="{Binding IsBusy}"
                           Style="{StaticResource CenterActivityIndicator}"
                           VerticalOptions="StartAndExpand" />

        <tabStrip:TabITemListView BackgroundColor="{StaticResource ListViewBgColor}"
                                  ItemsSource="{Binding MatchCommentaries}"
                                  HasUnevenRows="True"
                                  IsPullToRefreshEnabled="True"
                                  IsVisible="{Binding IsNotBusy}"
                                  IsRefreshing="{Binding IsRefreshing}"
                                  RefreshCommand="{Binding RefreshCommand}"
                                  VerticalOptions="FillAndExpand"
                                  SeparatorColor="Transparent">
            <tabStrip:TabITemListView.Header>
                <StackLayout>
                    <Label Style="{StaticResource NoInfo}"
                           IsVisible="{Binding NoData}"
                           Text="There is no data" />
                    <Grid IsVisible="{Binding HasTrackerData}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <FlexLayout Grid.Column="0"
                                    Grid.Row="0"
                                    IsVisible="{Binding TrackerVisible}">
                            <WebView Source="{Binding WidgetContent}"
                                     Style="{StaticResource MatchBallTrackerWebView}" />
                        </FlexLayout>
                        <Button  Grid.Column="0"
                                 Grid.Row="0"
                                 IsVisible="{Binding TrackerVisible}"
                                 Style="{StaticResource MatchBallTrackerCollapseIcon}"
                                 Command="{Binding OnCollapseTracker}" />
                    </Grid>
                    <FlexLayout Style="{StaticResource MatchBallTrackerGroup}"
                                IsVisible="{Binding TrackerHidden}">
                        <Label Text="VIEW BALL TRACKER"
                               Style="{StaticResource GroupName}" />
                        <Button Style="{StaticResource MatchBallTrackerExpandIcon}"
                                Command="{Binding OnExpandTracker}" />
                        <FlexLayout.GestureRecognizers>
                            <TapGestureRecognizer  Command="{Binding OnExpandTracker}" />
                        </FlexLayout.GestureRecognizers>
                    </FlexLayout>
                    <BoxView Style="{StaticResource HorizontalLine}"
                             IsVisible="{Binding TrackerHidden}" />
                    <FlexLayout Style="{StaticResource Group}"
                                IsVisible="{Binding HasCommentariesData}">
                        <Label Style="{StaticResource GroupName}"
                               Text="COMMENTARIES" />
                    </FlexLayout>
                </StackLayout>
            </tabStrip:TabITemListView.Header>
            <tabStrip:TabITemListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <StackLayout>
                            <BoxView Style="{StaticResource HorizontalLine}" />
                            <Grid Style="{StaticResource MatchTrackerCommentariesRow}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource CommentaryMinuteWidthSize}" />
                                    <ColumnDefinition Width="{StaticResource CommentaryIconWidthSize}" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0"
                                       Grid.Column="0"
                                       Style="{StaticResource MatchTrackerMinutes}"
                                       Text="{Binding MatchTime}" />
                                <Image  Grid.Row="0"
                                        Grid.Column="1"
                                        Source="{Binding ImageSource}"
                                        Style="{StaticResource MatchTrackerCommentariesIcons}" />
                                <Label Grid.Row="0"
                                       Grid.Column="2"
                                       Style="{StaticResource MatchTrackerCommentariesText}"
                                       TextColor="{Binding CommentaryTextColor}"
                                       Text="{Binding CommentaryText}" />
                            </Grid>
                        </StackLayout>
                    </ViewCell>
                </DataTemplate>
            </tabStrip:TabITemListView.ItemTemplate>
            <tabStrip:TabITemListView.Footer>
                <StackLayout BackgroundColor="Transparent"
                             HorizontalOptions="Center"
                             HeightRequest="300">
                    <Button Text="{Binding ShowLessMoreButtonText}"
                            IsVisible="{Binding HasCommentariesData}"
                            Style="{StaticResource MatchTrackerShowMoreButton}"
                            Command="{Binding ShowMoreCommentariesCommand}"></Button>
                </StackLayout>
            </tabStrip:TabITemListView.Footer>
        </tabStrip:TabITemListView>
    </FlexLayout>
</DataTemplate>