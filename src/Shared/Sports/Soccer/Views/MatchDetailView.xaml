<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage
    x:Class="LiveScore.Soccer.Views.MatchDetailView"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:commonConverters="clr-namespace:LiveScore.Common.Converters;assembly=LiveScore.Common"
    xmlns:coreConverters="clr-namespace:LiveScore.Core.Converters;assembly=LiveScore.Core"
    xmlns:coreTemplates="clr-namespace:LiveScore.Core.Views.Templates;assembly=LiveScore.Core"
    xmlns:matchDetailInfo="clr-namespace:LiveScore.Soccer.Views.Templates.MatchDetailInfo"
    xmlns:prism="clr-namespace:Prism.Mvvm;assembly=Prism.Forms"
    xmlns:resources="clr-namespace:LiveScore.Soccer.ViewResources"
    x:Name="self"
    Title="Match Info"
    BackgroundColor="{StaticResource SecondColor}">
    <NavigationPage.TitleView>
        <coreTemplates:NavigationTitleTemplate Title="Match Info" prism:ViewModelLocator.AutowirePartialView="{x:Reference self}" />
    </NavigationPage.TitleView>
    <ContentPage.ToolbarItems>
        <ToolbarItem Icon="images/common/favorite.png" />
    </ContentPage.ToolbarItems>
    <ContentPage.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <resources:MatchDetailViewResource />
            </ResourceDictionary.MergedDictionaries>
            <coreConverters:FirstCharConverter x:Key="FirstCharConverter" />
            <commonConverters:TextNotEmptyConverter x:Key="textNotEmptyConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>
    <ContentPage.Content>
        <StackLayout>
            <StackLayout Style="{StaticResource MatchGeneralInfoContainer}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="80" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <StackLayout
                        Grid.Row="0"
                        Grid.Column="0"
                        Style="{StaticResource MatchGeneralInfoHomeTeam}">
                        <FlexLayout Style="{StaticResource MatchGeneralWinnerInfoContainer}">
                            <Image Source="{Binding MatchViewModel.Match.HomePenaltyImage}" Style="{StaticResource MatchGeneralInfoWinnerInfoIcon}" />
                            <Image Source="{Binding MatchViewModel.Match.HomeSecondLegImage}" Style="{StaticResource MatchGeneralInfoWinnerInfoIcon}" />
                        </FlexLayout>

                        <Label Style="{StaticResource MatchGeneralInfoHomeTeamName}" Text="{Binding MatchViewModel.Match.Teams[0].Name}" />
                        <Button Style="{StaticResource MatchGeneralInfoTeamLogo}" Text="{Binding MatchViewModel.Match.Teams[0].Name, Converter={StaticResource FirstCharConverter}}" />
                    </StackLayout>
                    <FlexLayout
                        Grid.Row="0"
                        Grid.Column="1"
                        Style="{StaticResource MatchGeneralInfoScore}">
                        <Button Style="{StaticResource MatchGeneralInfoScoreBox}" Text="{Binding DisplayScore}" />
                    </FlexLayout>
                    <StackLayout
                        Grid.Row="0"
                        Grid.Column="2"
                        Style="{StaticResource MatchGeneralInfoAwayTeam}">
                        <Button Style="{StaticResource MatchGeneralInfoTeamLogo}" Text="{Binding MatchViewModel.Match.Teams[1].Name, Converter={StaticResource FirstCharConverter}}" />
                        <Label Style="{StaticResource MatchGeneralInfoAwayTeamName}" Text="{Binding MatchViewModel.Match.Teams[1].Name}" />
                        <FlexLayout Style="{StaticResource MatchGeneralWinnerInfoContainer}">
                            <Image Source="{Binding MatchViewModel.Match.AwayPenaltyImage}" Style="{StaticResource MatchGeneralInfoWinnerInfoIcon}" />
                            <Image Source="{Binding MatchViewModel.Match.AwaySecondLegImage}" Style="{StaticResource MatchGeneralInfoWinnerInfoIcon}" />
                        </FlexLayout>
                    </StackLayout>
                </Grid>
                <StackLayout>
                    <FlexLayout Style="{StaticResource FlexLayoutAlignCenter}">
                        <Label IsVisible="{Binding MatchViewModel.Match.MatchResult.EventStatus.IsLive}" Style="{StaticResource MatchGeneralInfoStatusLiveIcon}" />
                        <Label Style="{StaticResource MatchGeneralInfoStatus}" Text="{Binding MatchViewModel.DisplayMatchStatus}" />
                    </FlexLayout>
                    <Label Style="{StaticResource MatchGeneralInfoStatus}" Text="{Binding DisplayEventDateAndLeagueName}" />
                </StackLayout>
            </StackLayout>
            <StackLayout IsVisible="{Binding DisplaySecondLeg, Converter={StaticResource textNotEmptyConverter}}"
                         Style="{StaticResource MatchGeneralInfoImportant}">
                <Label Style="{StaticResource MatchGeneralInfoImportantContent}" Text="{Binding DisplaySecondLeg}" />
            </StackLayout>
            <!--<BoxView BackgroundColor="{StaticResource PrimaryColor}" Style="{StaticResource HorizontalLine}" />-->
            <StackLayout IsVisible="{Binding DisplayPenaltyShootOut, Converter={StaticResource textNotEmptyConverter}}"
                         Style="{StaticResource MatchGeneralInfoImportant}">
                <Label Style="{StaticResource MatchGeneralInfoImportantContent}" Text="{Binding DisplayPenaltyShootOut}" />
            </StackLayout>
            <ActivityIndicator
                x:Name="activity"
                IsEnabled="{Binding IsLoading}"
                IsRunning="{Binding IsLoading}"
                IsVisible="{Binding IsLoading}"
                Style="{StaticResource CenterActivityIndicator}" />
            <matchDetailInfo:MatchDetailInfoTemplate IsVisible="{Binding IsNotLoading}" />
        </StackLayout>
    </ContentPage.Content>
</ContentPage>